# PatentWorld

Interactive data visualization website exploring 9.36 million US patents (1976–2025) using data from [PatentsView](https://patentsview.org/). The site tells the story of American innovation through six narrative chapters with interactive charts.

**Live site**: [patentworld.com](https://patentworld.com)

## Tech Stack

- **Framework**: Next.js 14 (static export)
- **Charts**: Recharts + D3-geo
- **Styling**: Tailwind CSS, dark/light mode via next-themes
- **Data pipeline**: Python + DuckDB (processes ~25 GB of raw TSV data into ~1 MB of aggregated JSON)

## Project Structure

```
patentworld/
├── data-pipeline/          # Python scripts that process PatentsView data
│   ├── config.py           # Shared paths, helpers, TSV reader functions
│   ├── 01_chapter1_landscape.py
│   ├── 02_chapter2_technology.py
│   ├── 03_chapter3_assignees.py
│   ├── 04_chapter4_geography.py
│   ├── 05_chapter5_inventors.py
│   ├── 06_chapter6_citations.py
│   ├── 07_explore_data.py
│   └── requirements.txt
├── src/
│   ├── app/                # Next.js pages (homepage, 6 chapters, explore, about)
│   ├── components/         # Reusable UI, chart, and layout components
│   ├── hooks/              # useChapterData, useInView, useWindowSize
│   └── lib/                # Types, colors, formatters
├── public/
│   ├── data/               # Pre-computed JSON (output of data pipeline)
│   └── geo/                # TopoJSON maps
├── out/                    # Static export (generated by `npm run build`)
├── next.config.mjs
├── tailwind.config.ts
└── package.json
```

---

## Deployment Guide

Since the site is a **fully static export** (HTML + JS + JSON, ~2.8 MB total), it can be hosted on any static file host. No server-side runtime is needed.

### Prerequisites

- **Node.js** >= 18 (tested with v20)
- **npm** (comes with Node.js)

### Step 1: Install dependencies and build

```bash
cd /home/saerom/projects/patentworld
npm install
npm run build
```

This generates the `out/` directory containing the complete static site.

### Step 2: Test locally

```bash
npx serve out
```

Open http://localhost:3000 to verify everything works.

---

### Option A: Deploy to Vercel (Recommended)

Vercel is the company behind Next.js and offers the smoothest deployment experience with free hosting for personal projects.

1. **Create a Vercel account** at https://vercel.com (free tier is sufficient).

2. **Install the Vercel CLI**:
   ```bash
   npm install -g vercel
   ```

3. **Push your code to GitHub** (if not already):
   ```bash
   cd /home/saerom/projects/patentworld
   git init
   git add -A
   git commit -m "Initial commit"
   ```
   Then create a repository on https://github.com/new and push:
   ```bash
   git remote add origin https://github.com/YOUR_USERNAME/patentworld.git
   git branch -M main
   git push -u origin main
   ```

4. **Import the project on Vercel**:
   - Go to https://vercel.com/new
   - Select "Import Git Repository" and choose your `patentworld` repo
   - Vercel auto-detects Next.js — no configuration needed
   - Click **Deploy**

5. **Set up custom domain**:
   - In Vercel dashboard, go to your project → Settings → Domains
   - Add `patentworld.com`
   - Vercel will show DNS records to configure. Go to your domain registrar and set:
     - **A record**: `76.76.21.21`
     - **CNAME record** (for `www`): `cname.vercel-dns.com`
   - Wait for DNS propagation (usually 5–30 minutes)
   - Vercel automatically provisions an SSL certificate

6. **Future updates**: Every push to `main` triggers an automatic rebuild and deploy.

---

### Option B: Deploy to Netlify

1. **Create a Netlify account** at https://netlify.com (free tier available).

2. **Push code to GitHub** (same as Vercel step 3 above).

3. **Import on Netlify**:
   - Go to https://app.netlify.com/start
   - Connect your GitHub repo
   - Set build settings:
     - **Build command**: `npm run build`
     - **Publish directory**: `out`
   - Click **Deploy site**

4. **Custom domain**:
   - Go to Site settings → Domain management → Add custom domain
   - Add `patentworld.com`
   - Configure DNS at your registrar:
     - **A record**: Use the IP Netlify provides
     - **CNAME** (for `www`): `YOUR_SITE.netlify.app`
   - Netlify auto-provisions SSL

---

### Option C: Deploy to GitHub Pages (Free)

1. **Push code to GitHub** (same as above).

2. **Install the `gh-pages` package**:
   ```bash
   npm install --save-dev gh-pages
   ```

3. **Add a deploy script** to `package.json`:
   ```json
   "scripts": {
     "deploy": "npm run build && gh-pages -d out"
   }
   ```

4. **If using a custom domain**, create `public/CNAME` with your domain:
   ```
   patentworld.com
   ```
   Then rebuild so it's included in `out/`.

5. **Deploy**:
   ```bash
   npm run deploy
   ```

6. **Configure GitHub**:
   - Go to your repo → Settings → Pages
   - Source: "Deploy from a branch", branch: `gh-pages`, folder: `/ (root)`
   - Add custom domain: `patentworld.com`

7. **Configure DNS** at your registrar:
   - **A records** (all four):
     ```
     185.199.108.153
     185.199.109.153
     185.199.110.153
     185.199.111.153
     ```
   - **CNAME** (for `www`): `YOUR_USERNAME.github.io`

8. Enable "Enforce HTTPS" in GitHub Pages settings once DNS propagates.

---

### Option D: Deploy to Any Static Host (Cloudflare Pages, AWS S3, etc.)

The `out/` directory is a self-contained static site. Upload it to any static hosting service:

**Cloudflare Pages**:
```bash
npm install -g wrangler
wrangler pages deploy out --project-name=patentworld
```

**AWS S3 + CloudFront**:
```bash
aws s3 sync out/ s3://your-bucket-name --delete
# Then configure CloudFront distribution pointing to the S3 bucket
```

**Any web server (nginx, Apache, etc.)**:
```bash
# Copy the out/ directory to your server
rsync -avz out/ user@yourserver.com:/var/www/patentworld/
```

Example nginx config:
```nginx
server {
    listen 80;
    server_name patentworld.com www.patentworld.com;
    root /var/www/patentworld;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

---

## Updating the Data

If PatentsView releases new data and you want to regenerate the JSON files:

1. Download updated TSV zip files from https://patentsview.org/download/data-download-tables into your data directory.

2. Update the `DATA_DIR` path in `data-pipeline/config.py` if needed.

3. Install Python dependencies:
   ```bash
   cd data-pipeline
   pip install -r requirements.txt
   ```

4. Run the pipeline scripts (total runtime ~2–3 hours):
   ```bash
   python 01_chapter1_landscape.py
   python 02_chapter2_technology.py
   python 03_chapter3_assignees.py
   python 04_chapter4_geography.py
   python 05_chapter5_inventors.py
   python 06_chapter6_citations.py
   python 07_explore_data.py
   ```

5. Rebuild and redeploy the site:
   ```bash
   npm run build
   # Then deploy using your chosen method above
   ```

---

## Domain Registration

If you haven't purchased `patentworld.com` yet:

1. Check availability at a domain registrar (Namecheap, Google Domains, Cloudflare Registrar, etc.)
2. Purchase the domain (~$10–15/year for a `.com`)
3. Configure DNS records as described in the deployment option you chose above

---

## Development

```bash
npm run dev          # Start dev server at http://localhost:3000
npm run build        # Generate static export to out/
npm run lint         # Run ESLint
npx serve out        # Serve the static build locally
```

"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8539],{58539:function(e,t,n){n.r(t),n.d(t,{PWChoroplethMap:function(){return M}});var r=n(57437),a=n(2265),o=n(64318),i=n(32603);function l(e,t){var n=(0,o.O$)(e),r=(n+(0,o.O$)(t))/2;if((0,o.Wn)(r)<o.Ho)return function(e){var t=(0,o.mC)(e);function n(e,n){return[e*t,(0,o.O$)(n)/t]}return n.invert=function(e,n){return[e/t,(0,o.ZR)(n*t)]},n}(e);var a=1+n*(2*r-n),i=(0,o._b)(a)/r;function l(e,t){var n=(0,o._b)(a-2*r*(0,o.O$)(t))/r;return[n*(0,o.O$)(e*=r),i-n*(0,o.mC)(e)]}return l.invert=function(e,t){var n=i-t,l=(0,o.fv)(e,(0,o.Wn)(n))*(0,o.Xx)(n);return n*r<0&&(l-=o.pi*(0,o.Xx)(e)*(0,o.Xx)(n)),[l/r,(0,o.ZR)((a-(e*e+n*n)*r*r)/(2*r))]},l}function s(){var e,t,n,r;return(e=0,t=o.pi/3,(r=(n=(0,i.r)(l))(e,t)).parallels=function(r){return arguments.length?n(e=r[0]*o.uR,t=r[1]*o.uR):[e*o.RW,t*o.RW]},r).scale(155.424).center([0,33.6442])}var u=n(72713),c=n(24427),f=n(79989),d=n(10219),m=n(50659);let h={"01":"AL","02":"AK","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY"},p={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},v=m.ZP.sequentialStops(7);function x(e){return e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(0),"K"):e.toLocaleString("en-US")}function M(e){let{data:t,valueLabel:n="Patents",valueFormatter:i=x}=e,l=(0,a.useRef)(null),[M,N]=(0,a.useState)(null),[g,A]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetch("".concat("/patentworld","/geo/us-states.json")).then(e=>e.json()).then(e=>N(e))},[]);let C=(0,a.useMemo)(()=>Object.values(t),[t]),S=(0,a.useMemo)(()=>{if(0===C.length)return(0,f.Z)().domain([0,1]).range(v);let e=Math.max(...C);if(0===e)return(0,f.Z)().domain([0,1]).range(v);let t=Math.pow(10,Math.floor(Math.log10(e)));return(0,f.Z)().domain([0,Math.ceil(e/t)*t]).range(v)},[C]),y=(0,a.useMemo)(()=>{if(!M)return[];let e=M.objects.states;return d.Z(M,e).features},[M]),I=(0,a.useMemo)(()=>(function(){var e,t,n,r,a,i,l=s().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7]),c=s().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f=s().rotate([157,0]).center([-3,19.9]).parallels([8,18]),d={point:function(e,t){i=[e,t]}};function m(e){var t=e[0],o=e[1];return i=null,n.point(t,o),i||(r.point(t,o),i)||(a.point(t,o),i)}function h(){return e=t=null,m}return m.invert=function(e){var t=l.scale(),n=l.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?c:a>=.166&&a<.234&&r>=-.214&&r<-.115?f:l).invert(e)},m.stream=function(n){var r,a;return e&&t===n?e:(a=(r=[l.stream(t=n),c.stream(n),f.stream(n)]).length,e={point:function(e,t){for(var n=-1;++n<a;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<a;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<a;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<a;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<a;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<a;)r[e].polygonEnd()}})},m.precision=function(e){return arguments.length?(l.precision(e),c.precision(e),f.precision(e),h()):l.precision()},m.scale=function(e){return arguments.length?(l.scale(e),c.scale(.35*e),f.scale(e),m.translate(l.translate())):l.scale()},m.translate=function(e){if(!arguments.length)return l.translate();var t=l.scale(),i=+e[0],s=+e[1];return n=l.translate(e).clipExtent([[i-.455*t,s-.238*t],[i+.455*t,s+.238*t]]).stream(d),r=c.translate([i-.307*t,s+.201*t]).clipExtent([[i-.425*t+o.Ho,s+.12*t+o.Ho],[i-.214*t-o.Ho,s+.234*t-o.Ho]]).stream(d),a=f.translate([i-.205*t,s+.212*t]).clipExtent([[i-.214*t+o.Ho,s+.166*t+o.Ho],[i-.115*t-o.Ho,s+.234*t-o.Ho]]).stream(d),h()},m.fitExtent=function(e,t){return(0,u.qg)(m,e,t)},m.fitSize=function(e,t){return(0,u.mF)(m,e,t)},m.fitWidth=function(e,t){return(0,u.V6)(m,e,t)},m.fitHeight=function(e,t){return(0,u.rf)(m,e,t)},m.scale(1070)})().scale(1100).translate([480,300]),[]),W=(0,a.useMemo)(()=>(0,c.Z)().projection(I),[I]),b=(0,a.useCallback)((e,t,n)=>{var r;let a=l.current;if(!a)return;let o=a.getBoundingClientRect();A({x:e.clientX-o.left,y:e.clientY-o.top-10,content:"".concat(null!==(r=p[t])&&void 0!==r?r:t,": ").concat(null!=n?i(n):"N/A")})},[i]),O=(0,a.useCallback)(()=>A(null),[]),j=(0,a.useMemo)(()=>{let e=Object.entries(t).sort((e,t)=>t[1]-e[1]);return 0===e.length?[]:[...new Set([...e.slice(0,5).map(e=>{let[t]=e;return t}),...e.slice(-5).map(e=>{let[t]=e;return t})])]},[t]),k=(0,a.useMemo)(()=>{if(!y.length)return new Map;let e=new Map;return y.forEach(t=>{let n=h[String(t.id).padStart(2,"0")];if(n&&j.includes(n)){let r=W.centroid(t);r&&!isNaN(r[0])&&e.set(n,r)}}),e},[y,j,W]);if(!M)return(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading map..."});let[w,E]=S.domain();return(0,r.jsxs)("div",{className:"relative w-full h-full flex flex-col",children:[(0,r.jsxs)("svg",{ref:l,viewBox:"0 0 960 600",className:"w-full flex-1",children:[y.map(e=>{var n;let a=h[String(e.id).padStart(2,"0")],o=a?t[a]:void 0,i=null!=o?S(o):"hsl(var(--muted))";return(0,r.jsx)("path",{d:null!==(n=W(e))&&void 0!==n?n:"",fill:i,stroke:"hsl(var(--background))",strokeWidth:.8,className:"transition-opacity hover:opacity-80 cursor-pointer",onMouseMove:e=>b(e,null!=a?a:"",o),onMouseLeave:O},e.id)}),Array.from(k.entries()).map(e=>{let[t,[n,a]]=e;return(0,r.jsx)("text",{x:n,y:a,textAnchor:"middle",dominantBaseline:"central",fontSize:m.ZP.fontSize.annotation,fontWeight:m.ZP.fontWeight.axisLabel,fontFamily:m.ZP.fontFamily,fill:"hsl(var(--foreground))",pointerEvents:"none",children:t},"label-".concat(t))})]}),g&&(0,r.jsx)("div",{className:"absolute pointer-events-none z-10 rounded-md border bg-card px-3 py-1.5 text-sm shadow-md",style:{left:g.x,top:g.y,transform:"translate(-50%, -100%)"},children:g.content}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-2 mb-4 shrink-0",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:i(w)}),v.map((e,t)=>(0,r.jsx)("div",{className:"w-8 h-3 rounded-sm",style:{backgroundColor:e}},t)),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:i(E)}),(0,r.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:n})]})]})}}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5687],{75687:function(t,e,n){n.r(e),n.d(e,{PWSankeyDiagram:function(){return N}});var o=n(57437),r=n(2265);function i(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let o=-1;for(let r of t)(r=+e(r,++o,t))&&(n+=r)}return n}function l(t,e){let n;if(void 0===e)for(let e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let o=-1;for(let r of t)null!=(r=e(r,++o,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function u(t,e){return t.sourceLinks.length?t.depth:e-1}function s(t){return function(){return t}}function a(t,e){return c(t.source,e.source)||t.index-e.index}function f(t,e){return c(t.target,e.target)||t.index-e.index}function c(t,e){return t.y0-e.y0}function h(t){return t.value}function d(t){return t.index}function y(t){return t.nodes}function g(t){return t.links}function v(t,e){let n=t.get(e);if(!n)throw Error("missing: "+e);return n}function x({nodes:t}){for(let e of t){let t=e.y0,n=t;for(let n of e.sourceLinks)n.y0=t+n.width/2,t+=n.width;for(let t of e.targetLinks)t.y1=n+t.width/2,n+=t.width}}var p=Math.PI,_=2*p,k=_-1e-6;function m(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function M(){return new m}m.prototype=M.prototype={constructor:m,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,o){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+o)},bezierCurveTo:function(t,e,n,o,r,i){this._+="C"+ +t+","+ +e+","+ +n+","+ +o+","+(this._x1=+r)+","+(this._y1=+i)},arcTo:function(t,e,n,o,r){t=+t,e=+e,n=+n,o=+o,r=+r;var i=this._x1,l=this._y1,u=n-t,s=o-e,a=i-t,f=l-e,c=a*a+f*f;if(r<0)throw Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>1e-6){if(Math.abs(f*u-s*a)>1e-6&&r){var h=n-i,d=o-l,y=u*u+s*s,g=Math.sqrt(y),v=Math.sqrt(c),x=r*Math.tan((p-Math.acos((y+c-(h*h+d*d))/(2*g*v)))/2),_=x/v,k=x/g;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*a)+","+(e+_*f)),this._+="A"+r+","+r+",0,0,"+ +(f*h>a*d)+","+(this._x1=t+k*u)+","+(this._y1=e+k*s)}else this._+="L"+(this._x1=t)+","+(this._y1=e)}},arc:function(t,e,n,o,r,i){t=+t,e=+e,n=+n,i=!!i;var l=n*Math.cos(o),u=n*Math.sin(o),s=t+l,a=e+u,f=1^i,c=i?o-r:r-o;if(n<0)throw Error("negative radius: "+n);null===this._x1?this._+="M"+s+","+a:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-a)>1e-6)&&(this._+="L"+s+","+a),n&&(c<0&&(c=c%_+_),c>k?this._+="A"+n+","+n+",0,1,"+f+","+(t-l)+","+(e-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=a):c>1e-6&&(this._+="A"+n+","+n+",0,"+ +(c>=p)+","+f+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,o){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +o+"h"+-n+"Z"},toString:function(){return this._}};var w=Array.prototype.slice;function L(t){return function(){return t}}function b(t){return t[0]}function S(t){return t[1]}function j(t){return t.source}function E(t){return t.target}function A(t,e,n,o,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+o)/2,n,e,r,o,r)}function z(t){return[t.source.x1,t.y0]}function P(t){return[t.target.x0,t.y1]}var T=n(24989),C=n(97254);function N(t){let{nodes:e,links:n,width:p=900,height:_=600,ariaLabel:k}=t,[m,N]=(0,r.useState)(null),[W,X]=(0,r.useState)(null),{nodes:Y,links:Z}=(0,r.useMemo)(()=>{var t,o,r;if(0===e.length||0===n.length)return{nodes:[],links:[]};let k=new Map;for(let t of n){let e="".concat(t.source,"->").concat(t.target),n="".concat(t.target,"->").concat(t.source);if(k.has(n)){let o=k.get(n),r=o.value-t.value;r>0?o.value=r:r<0?(k.delete(n),k.set(e,{source:t.source,target:t.target,value:-r})):k.delete(n)}else k.set(e,{source:t.source,target:t.target,value:t.value})}let m=Array.from(k.values()).filter(t=>t.value>0&&t.source!==t.target),M={},w=new Map;for(let e of m){let n="".concat(e.source,"->").concat(e.target);w.set(n,e),(null!==(o=M[t=e.source])&&void 0!==o?o:M[t]=[]).push({target:e.target,key:n})}let L=new Set,b={},S=new Set;for(let t of(m.forEach(t=>{S.add(t.source),S.add(t.target)}),S))(null!==(r=b[t])&&void 0!==r?r:0)===0&&function t(e){var n,o;for(let{target:r,key:i}of(b[e]=1,null!==(n=M[e])&&void 0!==n?n:[]))L.has(i)||(1===b[r]?L.add(i):(null!==(o=b[r])&&void 0!==o?o:0)===0&&t(r));b[e]=2}(t);L.size>0&&(m=m.filter(t=>!L.has("".concat(t.source,"->").concat(t.target))));let j=(function(){let t,e,n=0,o=0,r=1,p=1,_=24,k=8,m,M=d,w=u,L=y,b=g,S=6;function j(){let u={nodes:L.apply(null,arguments),links:b.apply(null,arguments)};return function({nodes:t,links:n}){for(let[e,n]of t.entries())n.index=e,n.sourceLinks=[],n.targetLinks=[];let o=new Map(t.map((e,n)=>[M(e,n,t),e]));for(let[t,e]of n.entries()){e.index=t;let{source:n,target:r}=e;"object"!=typeof n&&(n=e.source=v(o,n)),"object"!=typeof r&&(r=e.target=v(o,r)),n.sourceLinks.push(e),r.targetLinks.push(e)}if(null!=e)for(let{sourceLinks:n,targetLinks:o}of t)n.sort(e),o.sort(e)}(u),function({nodes:t}){for(let e of t)e.value=void 0===e.fixedValue?Math.max(i(e.sourceLinks,h),i(e.targetLinks,h)):e.fixedValue}(u),function({nodes:t}){let e=t.length,n=new Set(t),o=new Set,r=0;for(;n.size;){for(let t of n)for(let{target:e}of(t.depth=r,t.sourceLinks))o.add(e);if(++r>e)throw Error("circular link");n=o,o=new Set}}(u),function({nodes:t}){let e=t.length,n=new Set(t),o=new Set,r=0;for(;n.size;){for(let t of n)for(let{source:e}of(t.height=r,t.targetLinks))o.add(e);if(++r>e)throw Error("circular link");n=o,o=new Set}}(u),function(u){let s=function({nodes:e}){let o=l(e,t=>t.depth)+1,i=(r-n-_)/(o-1),u=Array(o);for(let t of e){let e=Math.max(0,Math.min(o-1,Math.floor(w.call(null,t,o))));t.layer=e,t.x0=n+e*i,t.x1=t.x0+_,u[e]?u[e].push(t):u[e]=[t]}if(t)for(let e of u)e.sort(t);return u}(u);m=Math.min(k,(p-o)/(l(s,t=>t.length)-1)),function(t){let n=function(t,e){let n;if(void 0===e)for(let e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let o=-1;for(let r of t)null!=(r=e(r,++o,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}(t,t=>(p-o-(t.length-1)*m)/i(t,h));for(let r of t){let t=o;for(let e of r)for(let o of(e.y0=t,e.y1=t+e.value*n,t=e.y1+m,e.sourceLinks))o.width=o.value*n;t=(p-t+m)/(r.length+1);for(let e=0;e<r.length;++e){let n=r[e];n.y0+=t*(e+1),n.y1+=t*(e+1)}(function(t){if(void 0===e)for(let{sourceLinks:e,targetLinks:n}of t)e.sort(f),n.sort(a)})(r)}}(s);for(let e=0;e<S;++e){let n=Math.pow(.99,e),o=Math.max(1-n,(e+1)/S);(function(e,n,o){for(let r=e.length,i=r-2;i>=0;--i){let r=e[i];for(let t of r){let e=0,o=0;for(let{target:n,value:r}of t.sourceLinks){let i=r*(n.layer-t.layer);e+=function(t,e){let n=e.y0-(e.targetLinks.length-1)*m/2;for(let{source:o,width:r}of e.targetLinks){if(o===t)break;n+=r+m}for(let{target:o,width:r}of t.sourceLinks){if(o===e)break;n-=r}return n}(t,n)*i,o+=i}if(!(o>0))continue;let r=(e/o-t.y0)*n;t.y0+=r,t.y1+=r,P(t)}void 0===t&&r.sort(c),E(r,o)}})(s,n,o),function(e,n,o){for(let r=1,i=e.length;r<i;++r){let i=e[r];for(let t of i){let e=0,o=0;for(let{source:n,value:r}of t.targetLinks){let i=r*(t.layer-n.layer);e+=function(t,e){let n=t.y0-(t.sourceLinks.length-1)*m/2;for(let{target:o,width:r}of t.sourceLinks){if(o===e)break;n+=r+m}for(let{source:o,width:r}of e.targetLinks){if(o===t)break;n-=r}return n}(n,t)*i,o+=i}if(!(o>0))continue;let r=(e/o-t.y0)*n;t.y0+=r,t.y1+=r,P(t)}void 0===t&&i.sort(c),E(i,o)}}(s,n,o)}}(u),x(u),u}function E(t,e){let n=t.length>>1,r=t[n];z(t,r.y0-m,n-1,e),A(t,r.y1+m,n+1,e),z(t,p,t.length-1,e),A(t,o,0,e)}function A(t,e,n,o){for(;n<t.length;++n){let r=t[n],i=(e-r.y0)*o;i>1e-6&&(r.y0+=i,r.y1+=i),e=r.y1+m}}function z(t,e,n,o){for(;n>=0;--n){let r=t[n],i=(r.y1-e)*o;i>1e-6&&(r.y0-=i,r.y1-=i),e=r.y0-m}}function P({sourceLinks:t,targetLinks:n}){if(void 0===e){for(let{source:{sourceLinks:t}}of n)t.sort(f);for(let{target:{targetLinks:e}}of t)e.sort(a)}}return j.update=function(t){return x(t),t},j.nodeId=function(t){return arguments.length?(M="function"==typeof t?t:s(t),j):M},j.nodeAlign=function(t){return arguments.length?(w="function"==typeof t?t:s(t),j):w},j.nodeSort=function(e){return arguments.length?(t=e,j):t},j.nodeWidth=function(t){return arguments.length?(_=+t,j):_},j.nodePadding=function(t){return arguments.length?(k=m=+t,j):k},j.nodes=function(t){return arguments.length?(L="function"==typeof t?t:s(t),j):L},j.links=function(t){return arguments.length?(b="function"==typeof t?t:s(t),j):b},j.linkSort=function(t){return arguments.length?(e=t,j):e},j.size=function(t){return arguments.length?(n=o=0,r=+t[0],p=+t[1],j):[r-n,p-o]},j.extent=function(t){return arguments.length?(n=+t[0][0],r=+t[1][0],o=+t[0][1],p=+t[1][1],j):[[n,o],[r,p]]},j.iterations=function(t){return arguments.length?(S=+t,j):S},j})().nodeId((t,e)=>e).nodeWidth(16).nodePadding(12).nodeAlign(u).extent([[20,20],[p-20,_-20]])({nodes:e.map(t=>({...t})),links:m.map(t=>({...t}))});return{nodes:j.nodes,links:j.links}},[e,n,p,_]),q=(function(t){var e=j,n=E,o=b,r=S,i=null;function l(){var l,u=w.call(arguments),s=e.apply(this,u),a=n.apply(this,u);if(i||(i=l=M()),t(i,+o.apply(this,(u[0]=s,u)),+r.apply(this,u),+o.apply(this,(u[0]=a,u)),+r.apply(this,u)),l)return i=null,l+""||null}return l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(n=t,l):n},l.x=function(t){return arguments.length?(o="function"==typeof t?t:L(+t),l):o},l.y=function(t){return arguments.length?(r="function"==typeof t?t:L(+t),l):r},l.context=function(t){return arguments.length?(i=null==t?null:t,l):i},l})(A).source(z).target(P),I=(0,r.useMemo)(()=>{let t={};return n.forEach(e=>{var n,o;t[e.source]=(null!==(n=t[e.source])&&void 0!==n?n:0)-e.value,t[e.target]=(null!==(o=t[e.target])&&void 0!==o?o:0)+e.value}),t},[n]),O=t=>{var e;let n=null!==(e=I[t])&&void 0!==e?e:0;return n>0?T.ZE[0]:n<0?T.ZE[5]:"hsl(var(--muted-foreground))"};return(0,o.jsxs)("div",{className:"relative w-full h-full",children:[(0,o.jsxs)("svg",{viewBox:"0 0 ".concat(p," ").concat(_),className:"w-full h-full","aria-hidden":"true","aria-label":null!=k?k:"Sankey diagram showing flows between ".concat(e.map(t=>t.name).join(", ")),children:[Z.map((t,n)=>{var r,i,l,u;let s="object"==typeof t.source?null!==(r=t.source.index)&&void 0!==r?r:0:t.source,a="object"==typeof t.target?null!==(i=t.target.index)&&void 0!==i?i:0:t.target,f=null===m||m===s||m===a;return(0,o.jsx)("path",{d:null!==(l=q(t))&&void 0!==l?l:"",fill:"none",stroke:O(s),strokeWidth:Math.max(1,null!==(u=t.width)&&void 0!==u?u:1),strokeOpacity:f?.35:.05,style:{transition:"stroke-opacity 0.2s"},onMouseEnter:n=>{var o,r;let i="object"==typeof t.source?t.source.name:null===(o=e[t.source])||void 0===o?void 0:o.name,l="object"==typeof t.target?t.target.name:null===(r=e[t.target])||void 0===r?void 0:r.name;X({x:n.clientX,y:n.clientY,content:"".concat(i," â†’ ").concat(l,"\n").concat((0,C.Py)(t.value)," inventors")})},onMouseMove:t=>X(e=>e?{...e,x:t.clientX,y:t.clientY}:null),onMouseLeave:()=>X(null)},"link-".concat(n))}),Y.map((t,e)=>{var n,r,i,l;let u=null!==(n=t.x0)&&void 0!==n?n:0,s=null!==(r=t.x1)&&void 0!==r?r:0,a=null!==(i=t.y0)&&void 0!==i?i:0,f=null!==(l=t.y1)&&void 0!==l?l:0,c=null===m||m===e;return(0,o.jsxs)("g",{children:[(0,o.jsx)("rect",{x:u,y:a,width:s-u,height:Math.max(1,f-a),fill:O(e),fillOpacity:c?.9:.3,rx:2,style:{cursor:"pointer",transition:"fill-opacity 0.2s"},onMouseEnter:n=>{var o;N(e);let r=null!==(o=I[e])&&void 0!==o?o:0;X({x:n.clientX,y:n.clientY,content:"".concat(t.name,"\nNet flow: ").concat(r>0?"+":"").concat((0,C.Py)(r)," inventors")})},onMouseMove:t=>X(e=>e?{...e,x:t.clientX,y:t.clientY}:null),onMouseLeave:()=>{N(null),X(null)}}),f-a>14&&(0,o.jsx)("text",{x:u<p/2?s+6:u-6,y:(a+f)/2,textAnchor:u<p/2?"start":"end",dominantBaseline:"middle",fontSize:10,fill:"hsl(var(--foreground))",fillOpacity:c?.9:.4,style:{transition:"fill-opacity 0.2s"},children:t.name.length>20?t.name.slice(0,18)+"...":t.name})]},"node-".concat(e))})]}),W&&(0,o.jsx)("div",{className:"fixed pointer-events-none z-50 rounded-lg border bg-card px-3 py-2 text-sm shadow-md",style:{...T.sz,left:W.x+12,top:W.y-10,maxWidth:280,whiteSpace:"pre-line"},children:W.content})]})}}}]);